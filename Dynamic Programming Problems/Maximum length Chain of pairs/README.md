This is a maximum length chain of pairs problem